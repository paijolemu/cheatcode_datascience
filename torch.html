<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyTorch - Data Science Cheat Codes</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <!-- PENTING: Pastikan div ini ada untuk Live Background -->
    <div id="tsparticles"></div>
    
    <nav id="sidebar">
        <!-- ... (Isi sidebar Anda yang sudah benar) ... -->
    </nav>

    <div id="main-content">
        <header>
            <h1>Deep Learning dengan PyTorch</h1>
            <p>Alur kerja lengkap untuk melatih Neural Network dari awal hingga akhir.</p>
        </header>
        <main>
            <h2>Alur Kerja Klasifikasi Gambar (MNIST)</h2>
            <div class="card-container">

                <!-- KARTU 1: PERSIAPAN DATA & MODEL -->
                <div class="card">
                    <div class="card-inner">
                        <h3>1. Persiapan Data & Arsitektur Model</h3>
                        <img src="https://i.imgur.com/r6eB28T.png" alt="Konsep Data Pipeline">
                        <div class="code-block">
                            <div class="code-block-header"><div class="code-block-dots"></div><button class="copy-button">Copy</button></div>
                            <pre><code>import torch
import torch.nn as nn
from torchvision import datasets, transforms
from torch.utils.data import DataLoader

# ==================================
# 1. MENYIAPKAN DATA PIPELINE
# ==================================

# Transformasi untuk normalisasi gambar
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.5,), (0.5,))
])

# Download dan muat dataset training
train_dataset = datasets.MNIST(
    root='./data', 
    train=True, 
    download=True, 
    transform=transform
)
# Muat data testing
test_dataset = datasets.MNIST(
    root='./data', 
    train=False, 
    download=True, 
    transform=transform
)

# Buat DataLoaders untuk iterasi per batch
train_loader = DataLoader(
    train_dataset, 
    batch_size=64, 
    shuffle=True
)
test_loader = DataLoader(
    test_dataset, 
    batch_size=1000, 
    shuffle=False
)

# ==================================
# 2. MEMBUAT ARSITEKTUR MODEL
# ==================================
class SimpleNN(nn.Module):
    def __init__(self):
        super(SimpleNN, self).__init__()
        self.flatten = nn.Flatten()
        self.linear_relu_stack = nn.Sequential(
            nn.Linear(28*28, 512),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(512, 512),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(512, 10) # 10 kelas (angka 0-9)
        )
    def forward(self, x):
        x = self.flatten(x)
        logits = self.linear_relu_stack(x)
        return logits

# Inisialisasi model
model = SimpleNN()
print("Model dan Data berhasil disiapkan!")</code></pre>
                        </div>
                    </div>
                </div>

                <!-- KARTU 2: TRAINING & EVALUASI -->
                <div class="card">
                    <div class="card-inner">
                        <h3>2. Training, Evaluasi & Visualisasi</h3>
                        <img src="https://raw.githubusercontent.com/paijolemu/cheatcode_datascience/main/images/scikitlearn_confusion_matrix.png" alt="Contoh Confusion Matrix">
                        <div class="code-block">
                            <div class="code-block-header"><div class="code-block-dots"></div><button class="copy-button">Copy</button></div>
                            <pre><code>import torch
import torch.nn as nn
import torch.optim as optim
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.metrics import confusion_matrix
# Pastikan data & model dari Kartu 1 sudah dijalankan
# train_loader, test_loader, model = ...

# ==================================
# 3. SETUP TRAINING
# ==================================
loss_fn = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)
num_epochs = 5

# ==================================
# 4. TRAINING LOOP
# ==================================
model.train() # Set model ke mode training
for epoch in range(num_epochs):
    for data, targets in train_loader:
        scores = model(data)
        loss = loss_fn(scores, targets)
        
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
    print(f"Epoch {epoch+1}/{num_epochs} | Loss: {loss.item():.4f}")

# ==================================
# 5. EVALUASI & VISUALISASI
# ==================================
model.eval() # Set model ke mode evaluasi
all_preds = []
all_targets = []
with torch.no_grad():
    for data, targets in test_loader:
        scores = model(data)
        _, predictions = torch.max(scores, 1)
        all_preds.extend(predictions.tolist())
        all_targets.extend(targets.tolist())

# Visualisasi dengan Confusion Matrix
cm = confusion_matrix(all_targets, all_preds)
plt.figure(figsize=(8, 6))
sns.heatmap(cm, annot=True, fmt='d', cmap='BuPu')
plt.title('Confusion Matrix - PyTorch')
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.show()</code></pre>
                        </div>
                    </div>
                </div>

            </div>
        </main>
        
        <footer class="page-navigation">
            <!-- ... (Isi footer Anda yang sudah benar) ... -->
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
    <script src="script.js?v=torch_page_fixed"></script> <!-- Ganti versi -->
</body>
</html>
