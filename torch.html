<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyTorch - Data Science Cheat Codes</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <div id="tsparticles"></div>
    
    <nav id="sidebar">
        <button id="sidebar-toggle"><i class="fa-solid fa-bars"></i></button>
        <ul class="sidebar-nav">
            <li class="nav-item"><a href="index.html"><i class="fa-solid fa-house nav-icon"></i><span class="nav-text">Home</span></a></li>
            <li class="nav-item"><a href="matplotlib.html"><i class="fa-solid fa-chart-pie nav-icon"></i><span class="nav-text">Matplotlib</span></a></li>
            <li class="nav-item"><a href="seaborn.html"><i class="fa-solid fa-water nav-icon"></i><span class="nav-text">Seaborn</span></a></li>
            <li class="nav-item"><a href="pandas.html"><i class="fa-solid fa-table nav-icon"></i><span class="nav-text">Pandas</span></a></li>
            <li class="nav-item"><a href="scikitlearn.html"><i class="fa-solid fa-robot nav-icon"></i><span class="nav-text">Scikit-learn</span></a></li>
            <li class="nav-item"><a href="torch.html"><i class="fa-solid fa-brain nav-icon"></i><span class="nav-text">PyTorch</span></a></li>
            <li class="nav-item"><a href="monai.html"><i class="fa-solid fa-lungs nav-icon"></i><span class="nav-text">MONAI</span></a></li>
            <li class="nav-item"><a href="transformers.html"><i class="fa-solid fa-language nav-icon"></i><span class="nav-text">Transformers</span></a></li>
            <li class="nav-item"><a href="about.html"><i class="fa-solid fa-user-circle nav-icon"></i><span class="nav-text">About</span></a></li>
        </ul>
        <div class="sidebar-footer">
            <button id="theme-toggle" title="Ganti Tema">
                <i class="fas fa-moon icon-moon"></i>
                <i class="fas fa-sun icon-sun"></i>
            </button>
        </div>
    </nav>

    <div id="main-content">
        <header>
            <h1>Contoh Lengkap PyTorch</h1>
            <p>Dua alur kerja Deep Learning yang bisa dijalankan secara mandiri.</p>
        </header>
        <main>
            <h2>Klasifikasi & Regresi</h2>
            <div class="card-container">

                <!-- KARTU 1: KLASIFIKASI GAMBAR (MNIST) -->
                <div class="card">
                    <div class="card-inner">
                        <h3>1. Klasifikasi Gambar (MNIST)</h3>
                        <img src="https://github.com/paijolemu/cheatcode_datascience/blob/main/images/0fcd104e-28eb-4c95-9df1-30ae85c2b7df.jpg?raw=true" alt="Confusion Matrix PyTorch">
                        <div class="code-block">
                            <div class="code-block-header"><div class="code-block-dots"><div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div></div><button class="copy-button">Copy</button></div>
                            <pre><code>import torch, torch.nn as nn, torch.optim as optim
from torchvision import datasets, transforms
from torch.utils.data import DataLoader
import matplotlib.pyplot as plt, seaborn as sns
from sklearn.metrics import confusion_matrix

# 1. DATA PIPELINE
transform = transforms.Compose([transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,))])
train_dset = datasets.MNIST('./data', train=True, download=True, transform=transform)
test_dset = datasets.MNIST('./data', train=False, download=True, transform=transform)
train_loader = DataLoader(train_dset, batch_size=64, shuffle=True)
test_loader = DataLoader(test_dset, batch_size=1000, shuffle=False)

# 2. ARSITEKTUR MODEL
class ClassifierNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.stack = nn.Sequential(
            nn.Flatten(),
            nn.Linear(28*28, 512), nn.ReLU(), nn.Dropout(0.2),
            nn.Linear(512, 10))
    def forward(self, x): return self.stack(x)
model = ClassifierNN()

# 3. TRAINING
loss_fn = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)
num_epochs = 5
model.train()
for epoch in range(num_epochs):
    for data, targets in train_loader:
        scores = model(data)
        loss = loss_fn(scores, targets)
        optimizer.zero_grad(); loss.backward(); optimizer.step()
    print(f"Epoch {epoch+1}, Loss: {loss.item():.4f}")

# 4. EVALUASI
model.eval()
preds, actual = [], []
with torch.no_grad():
    for data, targets in test_loader:
        scores = model(data)
        _, predictions = torch.max(scores, 1)
        preds.extend(predictions.numpy())
        actual.extend(targets.numpy())

cm = confusion_matrix(actual, preds)
sns.heatmap(cm, annot=True, fmt='d', cmap='BuPu')
plt.title('Confusion Matrix - PyTorch Classification')
plt.xlabel('Predicted'); plt.ylabel('Actual'); plt.show()
</code></pre>
                        </div>
                    </div>
                </div>

                <!-- KARTU 2: REGRESI DENGAN NEURAL NETWORK -->
                <div class="card">
                    <div class="card-inner">
                        <h3>2. Regresi (Memprediksi Angka)</h3>
                        <img src="https://github.com/paijolemu/cheatcode_datascience/blob/main/images/b4fcb472-3ab1-499c-805c-28e8dafdaf4e.jpg?raw=true" alt="Hasil Linear Regression PyTorch">
                        <div class="code-block">
                            <div class="code-block-header"><div class="code-block-dots"><div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div></div><button class="copy-button">Copy</button></div>
                            <pre><code>import torch, torch.nn as nn, torch.optim as optim
import matplotlib.pyplot as plt
import numpy as np

# 1. DATA SINTETIS
X = np.linspace(0, 50, 100).reshape(-1, 1)
y = (2 * X + 1 + np.random.randn(100, 1) * 5).reshape(-1, 1)

X_tensor = torch.tensor(X, dtype=torch.float32)
y_tensor = torch.tensor(y, dtype=torch.float32)

# 2. ARSITEKTUR MODEL REGRESI
class RegressionNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.linear = nn.Linear(1, 1)
    def forward(self, x): return self.linear(x)
model = RegressionNN()

# 3. TRAINING
loss_fn = nn.MSELoss()
optimizer = optim.SGD(model.parameters(), lr=0.001)
num_epochs = 100
for epoch in range(num_epochs):
    y_pred = model(X_tensor)
    loss = loss_fn(y_pred, y_tensor)
    optimizer.zero_grad(); loss.backward(); optimizer.step()
    if (epoch+1) % 20 == 0:
      print(f'Epoch {epoch+1}, Loss: {loss.item():.4f}')

# 4. EVALUASI & VISUALISASI
model.eval()
with torch.no_grad():
    predicted = model(X_tensor).numpy()

plt.plot(X, y, 'ro', label='Data Asli')
plt.plot(X, predicted, 'b', label='Garis Regresi')
plt.title('Regresi Linear dengan PyTorch')
plt.legend(); plt.show()
</code></pre>
                        </div>
                    </div>
                </div>

            </div>
        </main>
        
        <footer class="page-navigation">
            <a href="scikitlearn.html" class="nav-button prev"><i class="fas fa-arrow-left arrow"></i><div><div class="nav-text-sub">Sebelumnya</div><div class="nav-text-main">Scikit-learn</div></div></a>
            <a href="monai.htmls" class="nav-button next"><i class="fas fa-arrow-right arrow"></i><div><div class="nav-text-sub">Selanjutnya</div><div class="nav-text-main">MONAI</div></div></a>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
    <script src="script.js?v=torch_page_complete_fix"></script>
</body>
</html>
