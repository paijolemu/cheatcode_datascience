<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MONAI - Data Science Cheat Codes</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <div id="tsparticles"></div>
    
    <nav id="sidebar">
        <button id="sidebar-toggle"><i class="fa-solid fa-bars"></i></button>
        <ul class="sidebar-nav">
            <li class="nav-item"><a href="index.html"><i class="fa-solid fa-house nav-icon"></i><span class="nav-text">Home</span></a></li>
            <li class="nav-item"><a href="matplotlib.html"><i class="fa-solid fa-chart-pie nav-icon"></i><span class="nav-text">Matplotlib</span></a></li>
            <li class="nav-item"><a href="seaborn.html"><i class="fa-solid fa-water nav-icon"></i><span class="nav-text">Seaborn</span></a></li>
            <li class="nav-item"><a href="pandas.html"><i class="fa-solid fa-table nav-icon"></i><span class="nav-text">Pandas</span></a></li>
            <li class="nav-item"><a href="scikitlearn.html"><i class="fa-solid fa-robot nav-icon"></i><span class="nav-text">Scikit-learn</span></a></li>
            <li class="nav-item"><a href="torch.html"><i class="fa-solid fa-brain nav-icon"></i><span class="nav-text">PyTorch</span></a></li>
            <li class="nav-item"><a href="monai.html"><i class="fa-solid fa-lungs nav-icon"></i><span class="nav-text">MONAI</span></a></li>
            <li class="nav-item"><a href="about.html"><i class="fa-solid fa-user-circle nav-icon"></i><span class="nav-text">About</span></a></li>
        </ul>
        <div class="sidebar-footer">
            <button id="theme-toggle" title="Ganti Tema">
                <i class="fas fa-moon icon-moon"></i>
                <i class="fas fa-sun icon-sun"></i>
            </button>
        </div>
    </nav>

    <div id="main-content">
        <header>
            <h1>Deep Learning untuk Citra Medis dengan MONAI</h1>
            <p>Alur kerja lengkap yang bisa dijalankan untuk klasifikasi gambar medis.</p>
        </header>
        <main>
            <h2>Klasifikasi Gambar MedNIST (Lengkap)</h2>
            <div class="card-container">

                <!-- KARTU TUNGGAL UNTUK ALUR KERJA LENGKAP -->
                <div class="card">
                    <div class="card-inner">
                        <h3>Alur Kerja Lengkap Klasifikasi MedNIST</h3>
                        <!-- Anda perlu membuat gambar hasil prediksi dari kode di bawah -->
                        <img src="https://i.imgur.com/333jI5J.png" alt="Contoh Prediksi MONAI">
                        <div class="code-block">
                            <div class="code-block-header"><div class="code-block-dots"><div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div></div><button class="copy-button">Copy</button></div>
                            <pre><code>import os, tempfile, glob, monai, torch, torch.nn as nn
import matplotlib.pyplot as plt
from monai.data import Dataset, DataLoader
from monai.transforms import (Compose, LoadImaged, EnsureChannelFirstd, 
ScaleIntensityd, RandRotate90d, RandZoomd)

# 1. DOWNLOAD DATASET
root_dir = tempfile.mkdtemp(); data_dir = os.path.join(root_dir, "MedNIST")
resource = "https://github.com/Project-MONAI/MONAI-extra-test-data/releases/download/0.8.1/MedNIST.tar.gz"
if not os.path.exists(data_dir):
    monai.apps.download_and_extract(resource, os.path.join(root_dir, "MedNIST.tar.gz"), root_dir)

# 2. PERSIAPAN DATA
all_files = sorted(glob.glob(os.path.join(data_dir, "*", "*.jpeg")))
class_names = sorted(os.path.basename(os.path.dirname(f)) for f in all_files)
num_classes = len(class_names)
class_indices = {name: i for i, name in enumerate(class_names)}
files_dict = [{"image": f, "label": class_indices[os.path.basename(os.path.dirname(f))]} for f in all_files]
val_split = int(len(files_dict) * 0.2); train_files, val_files = files_dict[:-val_split], files_dict[-val_split:]

# 3. TRANSFORMASI & DATALOADER
transforms = Compose([LoadImaged(keys=["image"]),EnsureChannelFirstd(keys=["image"]),ScaleIntensityd(keys=["image"])])
train_ds = Dataset(data=train_files, transform=transforms)
train_loader = DataLoader(train_ds, batch_size=300, shuffle=True)
val_ds = Dataset(data=val_files, transform=transforms)
val_loader = DataLoader(val_ds, batch_size=300)

# 4. DEFINISI & SETUP MODEL
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model = monai.networks.nets.DenseNet121(spatial_dims=2, in_channels=1, out_channels=num_classes).to(device)
loss_function = nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), 1e-4)
max_epochs = 4

# 5. TRAINING LOOP
for epoch in range(max_epochs):
    model.train(); epoch_loss = 0
    for batch_data in train_loader:
        inputs, labels = batch_data["image"].to(device), batch_data["label"].to(device)
        optimizer.zero_grad(); outputs = model(inputs); loss = loss_function(outputs, labels)
        loss.backward(); optimizer.step(); epoch_loss += loss.item()
    print(f"Epoch {epoch+1}, Loss: {epoch_loss/len(train_loader):.4f}")

# 6. EVALUASI & VISUALISASI
model.eval()
with torch.no_grad():
    val_data = next(iter(val_loader))
    val_images, val_labels = val_data["image"].to(device), val_data["label"].to(device)
    val_outputs = model(val_images)
    predicted_labels = torch.argmax(val_outputs, dim=1)

plt.figure("check", (10, 5))
for i in range(5):
    plt.subplot(2, 5, i + 1); plt.imshow(val_images[i, 0, :, :].cpu(), cmap="gray"); plt.axis('off')
    plt.subplot(2, 5, i + 6)
    color = "green" if val_labels[i] == predicted_labels[i] else "red"
    plt.text(0.5, 0.5, f"Asli: {class_names[val_labels[i]]}\nPred: {class_names[predicted_labels[i]]}",
             ha="center", va="center", color=color)
    plt.axis('off')
plt.suptitle("Contoh Hasil Prediksi Model MONAI"); plt.show()
</code></pre>
                        </div>
                    </div>
                </div>

            </div>
        </main>
        
        <footer class="page-navigation">
            <a href="pytorch.html" class="nav-button prev"><i class="fas fa-arrow-left arrow"></i><div><div class="nav-text-sub">Sebelumnya</div><div class="nav-text-main">PyTorch</div></div></a>
            <a href="transformers.html" class="nav-button next"><i class="fas fa-arrow-right arrow"></i><div><div class="nav-text-sub">Selanjutnya</div><div class="nav-text-main">Transformers</div></div></a>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
    <script src="script.js?v=monai_page_final_fix"></script>
</body>
</html>
